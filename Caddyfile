# Pillo 專案 Caddy 配置 - 支援攝影鏡頭 HTTPS 訪問

# 全域設定
{
	# 啟用本地 CA（自簽證書）
	local_certs
	# 禁用自動 HTTP 到 HTTPS 重定向（避免端口衝突）
	auto_https off
}

# 本機 HTTPS 訪問 - 連接 Docker 化的前端
localhost:3001 {
	tls internal
	reverse_proxy pillo-frontend:5173

	# 支援攝影鏡頭的 headers
	header {
		# 允許攝影機權限
		Permissions-Policy "camera=*, microphone=*"
		# 安全 headers
		X-Frame-Options "SAMEORIGIN"
		X-Content-Type-Options "nosniff"
	}
}

# 區域網 HTTPS 訪問 - 連接 Docker 化的前端
192.168.31.231:3001 {
	tls internal
	reverse_proxy pillo-frontend:5173

	# 支援攝影鏡頭的 headers
	header {
		Permissions-Policy "camera=*, microphone=*"
		X-Frame-Options "SAMEORIGIN"
		X-Content-Type-Options "nosniff"
	}
}

# 額外的域名（如果你想用更友善的名稱）
# pillo.local:3001 {
#     tls internal
#     reverse_proxy localhost:5173
#     header {
#         Permissions-Policy "camera=*, microphone=*"
#         X-Frame-Options "SAMEORIGIN"
#         X-Content-Type-Options "nosniff"
#     }
# }
